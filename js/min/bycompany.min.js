function createData(a,r){newArr=[],index=0;for(var e=0;e<a.length;e++)a[e].year==r&&(subArr=[],subArr.push(parseInt(index/10)),subArr.push(index%10),val=parseInt(parseFloat(a[e].x1)),subArr.push(val),newArr.push(subArr),index++);return newArr}$(document).ready(function(){$("select").material_select()});var globalData,globalOptions,globalChart,newArr;d3.csv("/data/bycompany.csv",function(a){$(function(){globalData=a,normalizedData=createData(a,2016);var r={chart:{type:"heatmap",marginTop:40,marginBottom:80,plotBorderWidth:1,renderTo:"container"},title:{text:""},xAxis:{categories:["","","","","","","","","",""]},yAxis:{categories:["","","","","","","","","",""],title:null},colorAxis:{min:0,minColor:"#d6fafe",maxColor:"#00a0b0"},legend:{align:"right",layout:"vertical",margin:0,verticalAlign:"top",y:30,symbolHeight:280},tooltip:{formatter:function(){return"<b> EMPRESA: <b>"+a[this.point.index].supplier+"</b> <br><b>CNPJ/CPF: <b>"+a[this.point.index].cnpj_cpf+"</b> <br><b>Valor: R$ <b>"+this.point.value.toFixed(0)+"</b> <br><b>Posição (Anual): <b> "+(this.series.data.length-this.point.index)+"</b>º<br>"}},series:[{name:"Valor por empresa",borderWidth:1,borderColor:"#d0e0e2",data:normalizedData,dataLabels:{enabled:!0,color:"#06515a"}}]};globalOptions=r;var e=new Highcharts.Chart(r);globalChart=e})}),$("#list").on("change",function(){var a=$("#list").val();newData=createData(globalData,a),globalOptions.series=[{name:"Valor por empresa",borderWidth:1,borderColor:"#FFFFFF",data:newData,dataLabels:{enabled:!0,color:"#000000"}}];new Highcharts.Chart(globalOptions)});